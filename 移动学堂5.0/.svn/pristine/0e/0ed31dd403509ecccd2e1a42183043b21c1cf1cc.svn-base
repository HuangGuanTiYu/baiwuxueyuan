//
//  LiveListCell.m
//  MoveSchool
//
//  Created by edz on 2017/8/22.
//
//

#import "LiveListCell.h"
#import "UIImageView+WebCache.h"
#import "HomePageModel.h"

@interface LiveListCell()

@property (nonatomic, strong) UIImageView *backImage;

@property (nonatomic, strong) UIView *titleView;

@property (nonatomic, strong) UILabel *stateLabel;

@property (nonatomic, strong) UILabel *titleLabel;

@property (nonatomic, strong) UIView *boomView;

@property (nonatomic, strong) UILabel *timeLabel;

@property (nonatomic, strong) UILabel *nameLabel;

@property (nonatomic, strong) UILabel *countLabel;

@end

@implementation LiveListCell

- (instancetype)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        
        self.backImage = [[UIImageView alloc] init];
        [self.contentView addSubview:self.backImage];
        
        self.titleView = [[UIView alloc] init];
        self.titleView.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:0.5f];
        [self.contentView addSubview:self.titleView];
        
        self.stateLabel = [[UILabel alloc] init];
        self.stateLabel.layer.cornerRadius = fillet;
        self.stateLabel.layer.masksToBounds = YES;
        self.stateLabel.layer.borderWidth = 1;
        self.stateLabel.font = [UIFont systemFontOfSize:ys_f24];
        self.stateLabel.textAlignment = NSTextAlignmentCenter;
        [self.titleView addSubview:self.stateLabel];
        
        self.titleLabel = [[UILabel alloc] init];
        self.titleLabel.textColor = [UIColor whiteColor];
        self.titleLabel.font = [UIFont systemFontOfSize:ys_f24];
        [self.titleView addSubview:self.titleLabel];
        
        self.boomView = [[UIView alloc] init];
        self.boomView.backgroundColor = [UIColor whiteColor];
        [self.contentView addSubview:self.boomView];
        
        self.timeLabel = [[UILabel alloc] init];
        self.timeLabel.font = [UIFont systemFontOfSize:ys_f24];
        self.timeLabel.textColor = AuxiliaryColor;
        [self.boomView addSubview:self.timeLabel];
        
        self.nameLabel = [[UILabel alloc] init];
        self.nameLabel.font = [UIFont systemFontOfSize:ys_f24];
        self.nameLabel.textColor = AuxiliaryColor;
        [self.boomView addSubview:self.nameLabel];
        
        self.countLabel = [[UILabel alloc] init];
        self.countLabel.textAlignment = NSTextAlignmentRight;
        self.countLabel.font = [UIFont systemFontOfSize:ys_f24];
        self.countLabel.textColor = AuxiliaryColor;
        [self.boomView addSubview:self.countLabel];
        
        self.backgroundColor = ViewBackColor;
    }
    
    return self;
}

- (void)layoutSubviews
{
    [super layoutSubviews];
    
    self.backImage.frame = CGRectMake(0, 0, self.contentView.width, self.contentView.width / 2);
    
    self.titleView.frame = CGRectMake(0, self.backImage.height - 35, self.contentView.width, 35);
    
    self.stateLabel.frame = CGRectMake(15, 0, 50, 17);
    self.stateLabel.centerY = self.titleView.height * 0.5;
    
    self.titleLabel.frame = CGRectMake(CGRectGetMaxX(self.stateLabel.frame) + 15, 0, self.titleView.width - CGRectGetMaxX(self.stateLabel.frame) - 30, self.stateLabel.height);
    self.titleLabel.centerY = self.stateLabel.centerY;
    
    self.boomView.frame = CGRectMake(0, CGRectGetMaxY(self.titleView.frame), self.contentView.width, 35);
    
    self.timeLabel.frame = CGRectMake(15, 0, 120, 17);
    self.timeLabel.centerY = self.boomView.height * 0.5;
    
    CGFloat nameLabelW = self.boomView.width - CGRectGetMaxX(self.timeLabel.frame);
    self.nameLabel.frame = CGRectMake(CGRectGetMaxX(self.timeLabel.frame) + mainSpacing, 0, nameLabelW * 0.5, self.timeLabel.height);
    
    self.nameLabel.centerY = self.timeLabel.centerY;
    
    self.countLabel.frame = CGRectMake(CGRectGetMaxX(self.nameLabel.frame), 0, (nameLabelW - 15) * 0.5 - 15, self.timeLabel.height);
    self.countLabel.centerY = self.nameLabel.centerY;
}

- (void)setModel:(HomePageModel *)model
{
    _model = model;
    
    [self.backImage sd_setImageWithURL:[NSURL URLWithString:model.image] placeholderImage:[UIImage imageNamed:@"zwt_kecheng"]];
    
    self.titleLabel.text = model.title;
    
    if ([model.living isEqualToString:@"1"]) { //正在直播
        self.stateLabel.text = @"直播中";
        self.stateLabel.backgroundColor = MainRedColor;
        self.stateLabel.textColor = [UIColor whiteColor];
        self.stateLabel.layer.borderColor = [UIColor clearColor].CGColor;
        self.countLabel.text = [NSString stringWithFormat:@"%@人参与",model.learnNum];

    }else if ([model.living isEqualToString:@"2"]) //预约
    {
        self.stateLabel.text = @"预约";
        self.stateLabel.backgroundColor = [UIColor clearColor];
        self.stateLabel.textColor = MainColor;
        self.stateLabel.layer.borderColor = MainColor.CGColor;
        self.countLabel.text = [NSString stringWithFormat:@"%@人预约",model.learnNum];

    }else //已预约
    {
        self.stateLabel.text = @"已预约";
        self.stateLabel.backgroundColor = [UIColor clearColor];
        self.stateLabel.textColor = AuxiliaryColor;
        self.stateLabel.layer.borderColor = AuxiliaryColor.CGColor;
        self.countLabel.text = [NSString stringWithFormat:@"%@人预约",model.learnNum];

    }
    
    self.timeLabel.text = model.indate;
    self.nameLabel.text = [NSString stringWithFormat:@"讲师：%@",model.nickname];
}

@end
